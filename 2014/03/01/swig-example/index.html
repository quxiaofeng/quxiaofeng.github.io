<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Xiaofeng QU"><title>A SWIG Example · Xiaofeng QU</title><meta name="description" content="SWIGSWIG is stand along software development tool. It connects code programmed in C and C++ with many high-level programming languages including pytho"><meta name="keywords" content=""><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div id="stage" class="container"><div class="row"><div id="side-bar" class="col-sm-3 col-xs-12 side-container invisible"><div class="vertical-text site-title"><h3 tabindex="-1" class="site-title-small"><a href="/" class="a-title">博客</a></h3><h1 tabindex="-1" class="site-title-large"><a href="/" class="a-title">曲晓峰</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div id="site-nav" class="site-title-links"><ul><li><a href="/">Home</a></li><li><a href="/archives">Archive</a></li><li><a href="/categories">Categories</a></li><li><a href="/tags">Tags</a></li><li><a href="//about/index.html">About</a></li><li><a href="//links/index.html">Links</a></li><li><a href="//3/1415926/index.html">Pi page</a></li><li><a href="//research/index.html">Research</a></li><li><a href="/talks/python-function.html"></a></li><li><a href="/talks/python-interface.html"></a></li><li class="soc"><a href="https://github.com/quxiaofeng" target="_blank" rel="noopener noreferrer"><i class="fa fa-github">&nbsp;</i></a><a href="https://twitter.com/quxiaofeng" target="_blank" rel="noopener noreferrer"><i class="fa fa-twitter">&nbsp;</i></a><a href="https://www.instagram.com/quxiaofeng" target="_blank" rel="noopener noreferrer"><i class="fa fa-instagram">&nbsp;</i></a><a href="http://www.quxiaofeng.me/atom.xml" target="_blank" rel="noopener noreferrer"><i class="fa fa-rss">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2018&nbsp;<a target="_blank" href="http://www.quxiaofeng.me" rel="noopener noreferrer">Xiaofeng QU</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer></div></div></div><div id="main-container" class="col-sm-9 col-xs-12 main-container invisible"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a>A SWIG Example</a></p><p class="post-meta"><span class="date meta-item">Posted at&nbsp;2014-03-01</span><span class="meta-item"><i class="fa fa-comment-o"></i><span>&nbsp;</span><a href="/2014/03/01/swig-example/#comments">Comments</a></span><span class="meta-item"><i class="fa fa-folder"></i><span>&nbsp;</span><a href="/categories/coding/" title="coding" class="a-tag">coding</a><span>&nbsp;</span></span><span class="meta-item"><i class="fa fa-tag"></i><span>&nbsp;</span><a href="/tags/coding/" title="coding" class="a-tag">coding</a><span>&nbsp;</span><a href="/tags/python/" title="python" class="a-tag">python</a><span>&nbsp;</span><a href="/tags/c/" title="c++" class="a-tag">c++</a><span>&nbsp;</span><a href="/tags/c/" title="c" class="a-tag">c</a><span>&nbsp;</span></span></p><p class="post-abstract"><h2 id="SWIG"><a href="#SWIG" class="headerlink" title="SWIG"></a><a href="http://www.swig.org" target="_blank" rel="noopener">SWIG</a></h2><p>SWIG is stand along software development tool. It connects code programmed in C and C++ with many high-level programming languages including python. SWIG is used to parse C/C++ interfaces and generate the ‘glue code’ required for the above target languages to call into the C/C++ code. </p>
<a id="more"></a>
<p>The idea of SWIG is to create a dynamic python library module, which calls the SDK DLL. The structure is shown below.</p>
<figure><br>  <img src="http://i.imgur.com/rPhlR7E.png"><br>  <figcaption><br>  SWIG interfacing principle<br>  </figcaption><br></figure>

<p>The SWIG compiles the DLL and H files under the instruction of the .i file (SWIG configuring file). The SWIG project generates the Python Dynamic Library file (pyd). This pyd file can be imported to python.</p>
<h2 id="A-Basic-But-Not-Simple-Example"><a href="#A-Basic-But-Not-Simple-Example" class="headerlink" title="A Basic But Not Simple Example"></a>A Basic But Not Simple Example</h2><ul>
<li><a href="https://github.com/quxiaofeng/swig-cpp-class-dll-wrapping-test" target="_blank" rel="noopener">github repo</a></li>
</ul>
<h3 id="1-Make-a-little-DLL-project"><a href="#1-Make-a-little-DLL-project" class="headerlink" title="1. Make a little DLL project."></a>1. Make a little DLL project.</h3><p>In the repo, this little DLL project is <strong>xiaoAdd</strong>. There is a <strong>class AddTest</strong>. This class has only one useful <strong>member function add</strong>.</p>
<p><code>AddTest.h</code></p>
<pre><code>/* AddTest.h */
#pragma once

class __declspec(dllexport) AddTest
{
public:
    AddTest(void);
    ~AddTest(void);
    int add(int a, int b);
};
</code></pre><p><code>AddTest.cpp</code></p>
<pre><code>/* AddTest.cpp */
#include &quot;AddTest.h&quot;

AddTest::AddTest(void)
{
}

AddTest::~AddTest(void)
{
}

int AddTest::add(int a, int b)
{
    return a+b;
}
</code></pre><p>Compile this project and get the results.</p>
<pre><code>xiaoAdd.dll
xiaoAdd.lib
xiaoAdd.pdb
</code></pre><h3 id="2-Make-a-Python-dynamic-module"><a href="#2-Make-a-Python-dynamic-module" class="headerlink" title="2. Make a Python dynamic module"></a>2. Make a Python dynamic module</h3><p>In the github repo, this module is xiaoA</p>
<p><em>AddTest.h</em></p>
<pre><code>/* AddTest.h */
#pragma once

class __declspec(dllimport)AddTest
{
public:
    AddTest(void);
    ~AddTest(void);
    int add(int a, int b);
};
</code></pre><p><em>xiaoAddModule.i</em></p>
<pre><code>/* xiaoAddModule.i */
%module xiaoAddModule

%{
/* Put header files here or function declarations like below */
#include &quot;AddTest.h&quot;
%}

%include &lt;windows.i&gt;
%include &quot;AddTest.h&quot;
</code></pre><h4 id="1-Compile-the-xiaoAddModule-i-for-xiaoAddModule-wrap-cxx"><a href="#1-Compile-the-xiaoAddModule-i-for-xiaoAddModule-wrap-cxx" class="headerlink" title="1. Compile the xiaoAddModule.i for xiaoAddModule_wrap.cxx."></a>1. Compile the xiaoAddModule.i for xiaoAddModule_wrap.cxx.</h4><h4 id="2-Build-the-project-Reference-including"><a href="#2-Build-the-project-Reference-including" class="headerlink" title="2. Build the project (Reference) including"></a>2. Build the project (<a href="http://stackoverflow.com/questions/11693047/how-to-create-a-dll-with-swig-from-visual-studio-2010" target="_blank" rel="noopener">Reference</a>) including</h4><pre><code>xiaoAddModule_wrap.cxx
AddTest.h
xiaoAdd.dll
xiaoAdd.lib
</code></pre><h4 id="3-Get-the-results"><a href="#3-Get-the-results" class="headerlink" title="3. Get the results"></a>3. Get the results</h4><pre><code>_xiaoAddModule.exp
_xiaoAddModule.lib
_xiaoAddModule.pdb
_xiaoAddModule.pyd
xiaoAddModule.py
xiaoAddmodule.pyc
</code></pre><h4 id="4-Write-the-Python-script-within-the-folder-where-above-results-are-located"><a href="#4-Write-the-Python-script-within-the-folder-where-above-results-are-located" class="headerlink" title="4. Write the Python script within the folder where above results are located."></a>4. Write the Python script within the folder where above results are located.</h4><p><code>test.py</code></p>
<pre><code># test.py
import xiaoAddModule
instance = xiaoAddModule.AddTest()
print &apos;The result of 2 + 3 = %r&apos; % (instance.add(2,3))
wait = input(&quot;PRESS ENTER TO EXIT.&quot;)
</code></pre><h2 id="A-Complex-Solution-For-A-Complex-Example"><a href="#A-Complex-Solution-For-A-Complex-Example" class="headerlink" title="A Complex Solution For A Complex Example"></a>A Complex Solution For A Complex Example</h2><p>When wrapping a complex 3rd party library, there are lots of classes and functions. We want to keep this interface nice and clean. A C++ wrapper is implemented as shown below.</p>
<figure><br>  <img src="http://i.imgur.com/lHar1Ig.png"><br>  <figcaption><br>  Double layer wrapping<br>  </figcaption><br></figure>

</p></div><div class="share"><span>Share</span>&nbsp;<span class="soc"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></span><span class="soc"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></span><span class="soc"><a href="http://twitter.com/home?status=http://www.quxiaofeng.me/2014/03/01/swig-example/%20Xiaofeng QU%20A SWIG Example" class="fa fa-twitter"></a></span></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/2014/03/01/matlab-coding-style/" title="Matlab Coding Style"><i class="fa fa-angle-double-left"></i>&nbsp;Previous post: Matlab Coding Style</a></span><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/2014/02/28/ctypes-example/" title="A Little ctypes Example">Next post: A Little ctypes Example&nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div><a id="comments"></a><div id="disqus_thread"></div><script>var disqus_shortname = 'quxiaofenggithub# [short_name] on disqus.com';
var disqus_identifier = '2014/03/01/swig-example/';
var disqus_title = 'A SWIG Example';
var disqus_url = 'http://www.quxiaofeng.me/2014/03/01/swig-example/';
(function () {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//quxiaofenggithub# [short_name] on disqus.com.disqus.com/count.js" async></script></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2018&nbsp;<a target="_blank" href="http://www.quxiaofeng.me" rel="noopener noreferrer">Xiaofeng QU</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer></div></div></div></div><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/google-analytics.js"></script><script src="/js/typography.js"></script></body></html>